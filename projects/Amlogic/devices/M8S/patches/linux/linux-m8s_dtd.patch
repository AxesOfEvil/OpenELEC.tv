--- a/arch/arm/boot/dts/amlogic/meson8m2_n200_2G.dtd	2015-06-09 13:55:58.000000000 +0300
+++ b/arch/arm/boot/dts/amlogic/meson8m2_n200_2G.dtd	2015-06-09 16:54:46.995576767 +0300
@@ -81,10 +81,15 @@
 		aml_reserved_start = <0x06000000>; /**reserved memory start */
 		aml_reserved_end = <0x05000000>;/**reserved memory end */
 		phys_offset = <0x00200000>;
-		linux,total-memory = <0x7fe00000>;
+		linux,total-memory = <0x7fe00000>;
 
-        #address-cells = <1>;
-        #size-cells = <1>;
+//$$ DEVICE="mem_4k2k_decoder"
+//$$ L3 PROP_U32 2 ="reg" 
+		mem_4k2k_decoder: region@1 {
+			region_name = "cma_4k2k";
+			linux,contiguous-region;
+			reg = <0x00000000 0x0c000000>;
+		};
 
         cma_0:region@0 {
            region_name = "cma_0";
@@ -148,7 +153,7 @@
 		compatible = "amlogic,deinterlace";
 		dev_name = "deinterlace";
 		status = "ok";
-		reserve-memory = <0x01800000>; //8x1920x1088x3/2=24M
+		reserve-memory = <0x02100000>; //10x1920x1088x3/2=33M
 	};
 
 /// ***************************************************************************************
@@ -175,9 +180,23 @@
                 compatible = "amlogic,vdec";
                 dev_name = "vdec.0";
                 status = "okay";
-                reserve-memory = <0x10000000>;
-                reserve-iomap = "true";
-        };
+                reserve-memory = <0x04000000>; // 64M
+//		reserve-iomap = "true";
+		linux,contiguous-region = <&mem_4k2k_decoder>;
+        };
+///	-	picture decoder
+//$$ MODULE="picture decoder"
+//$$ DEVICE="picdec"
+//$$ L2 PROP_STR = "status"
+//$$ L3 PROP_U32 2 ="reg"
+    picdec{
+		compatible = "amlogic,picdec";
+		dev_name = "picdec";								
+		status = "okay";
+        share-memory-name = "vdec0";
+        share-memory-offset = <0>;
+        share-memory-size = <0x04000000>; //64M
+	}; 
 
 /// ***************************************************************************************
 ///	-	DISP&MM-PostProcess
@@ -216,24 +235,6 @@
 //		dev_name = "amvdec_656in";
 //		status = "ok";
 //		reg = <0x1e400000 0x00100000>;
-/// ***************************************************************************************
-///	-	DISP&MM-VDIN
-//$$ MODULE = "DISP&MM-VDIN"
-//$$ DEVICE="vdin0"
-//$$ L2 PROP_STR = "status"
-//$$ L2 PROP_U32 2 = "reg"
-//$$ L2 PROP_U32 = "irq"
-//$$ L2 PROP_U32 = "vdin_id"
-    vdin0{
-        compatible = "amlogic,vdin";
-        dev_name = "vdin0";
-        status = "ok";
-	reserve-memory = <0x00100000>;//only for mpeg2vdin use
-	 reserve-iomap = "true";
-        irq = <115>;
-        vdin_id = <0>;
-	};
-	
 //	};
 //
 /// ***************************************************************************************
@@ -244,16 +245,16 @@
 //$$ L2 PROP_U32 2 = "reg"
 //$$ L2 PROP_U32 = "irq"
 //$$ L2 PROP_U32 = "vdin_id"
-    vdin1{
-        compatible = "amlogic,vdin";
-        dev_name = "vdin1";
-        status = "ok";
-        reserve-memory = <0x01000000>;
-        miracast_size = <1920 1080>;//1920x1080x2x4=17M
-        reserve-iomap = "true";
-        irq = <117>;
-        vdin_id = <1>;
-    };
+//    vdin1{
+//        compatible = "amlogic,vdin";
+//        dev_name = "vdin1";
+//        status = "ok";
+//        reserve-memory = <0x01000000>;
+//	  miracast_size = <1920 1080>;//1920x1080x2x4=17M
+//	  reserve-iomap = "true";
+//        irq = <117>;
+//        vdin_id = <1>;
+//	};
 
 /// ***************************************************************************************
 ///	-	DISP&MM-AMLVIDEO2
@@ -261,13 +262,13 @@
 //$$ DEVICE="amlvideo2"
 //$$ L2 PROP_STR = "status"
 //$$ L3 PROP_U32 2 ="reg"
-    amlvideo2{
-        compatible = "amlogic,amlvideo2";
-        dev_name = "amlvideo2.0";
-        status = "okay";
-        reserve-memory = <0x01800000>;
-        reserve-iomap = "true";
-    };
+//    amlvideo2{
+//		compatible = "amlogic,amlvideo2";
+//		dev_name = "amlvideo2.0";
+//		status = "okay";
+//		reserve-memory = <0x01800000>;
+//		reserve-iomap = "true";
+//	};
 
 /// ***************************************************************************************
 ///	-	ION
@@ -417,7 +418,9 @@
             status = "okay";
             power_gpio = "GPIOAO_6";
             power_gpio2 = "GPIOX_11";
-	};
+	    power_gpio3 = "GPIO_TEST_N";
+            valid = "high";
+	}; 
 
 /// ***************************************************************************************
 ///	-	MMC
@@ -455,7 +458,6 @@
 //$$ L2 PROP_STR 3 = "caps"
 //$$ L3 PROP_U32 = "f_min"
 //$$ L3 PROP_U32 = "f_max"
-//$$ L3 PROP_U32 = "f_max_w"
 //$$ L3 PROP_U32 = "max_req_size"
 //$$ L2 PROP_STR = "gpio_dat3"
 //$$ L2 PROP_STR = "jtag_pin"
@@ -472,12 +474,11 @@
             caps = "MMC_CAP_4_BIT_DATA","MMC_CAP_MMC_HIGHSPEED","MMC_CAP_SD_HIGHSPEED";
             f_min = <300000>;
             f_max = <50000000>;
-            f_max_w = <50000000>;
             max_req_size = <0x20000>;          /**128KB*/
             gpio_dat3 = "CARD_4";
             jtag_pin = "CARD_0";
             gpio_cd = "CARD_6";
-            gpio_ro = "GPIOZ_0";
+            //gpio_ro = "GPIOZ_0";
             irq_in = <3>;
             irq_out = <5>;
             card_type = <5>; /* 0:unknown, 1:mmc card(include eMMC), 2:sd card(include tSD), 3:sdio device(ie:sdio-wifi), 4:SD combo (IO+mem) card, 5:NON sdio device(means sd/mmc card), other:reserved */
@@ -533,20 +534,6 @@
         };
     };
 
-/// ***************************************************************************************
-///	-	MMC
-//$$ MODULE="MMC"
-//$$ DEVICE="aml_sdhc"
-//$$ L2 PROP_STR = "status"
-//$$ L3 PROP_U32 2 ="reg"
-//$$ L2 PROP_STR 6 = "pinctrl-names"
-//$$ L2 PROP_CHOICE "sdhc_pin_0_match" = "pinctrl-0"
-//$$ L2 PROP_CHOICE "sdhc_pin_1_match" = "pinctrl-1"
-//$$ L2 PROP_CHOICE "sdhc_pin_2_match" = "pinctrl-2"
-//$$ L2 PROP_CHOICE "sdhc_pin_3_match" = "pinctrl-3"
-//$$ L2 PROP_CHOICE "sdhc_pin_4_match" = "pinctrl-4"
-//$$ L2 PROP_CHOICE "sdjc_pin_5_match" = "pinctrl-5"
-// L2 PROP_CHOICE "sdhc_pin_6_match" = "pinctrl-6"
     sdhc{
         compatible = "amlogic,aml_sdhc";
         dev_name = "aml_sdhc.0";
@@ -616,8 +603,8 @@
             ocr_avail = <0x00200080>; // 3.3:0x200000, 1.8+3.3:0x00200080
             caps = "MMC_CAP_8_BIT_DATA","MMC_CAP_MMC_HIGHSPEED","MMC_CAP_SD_HIGHSPEED", "MMC_CAP_NONREMOVABLE","MMC_CAP_ERASE", "MMC_CAP_HW_RESET"; // MMC_CAP_NEEDS_POLL -- for detect, MMC_CAP_NONREMOVABLE -- for eMMC/TSD
             caps2 = "MMC_CAP2_HS200_1_8V_SDR";
-	    f_min = <300000>;
-            f_max = <100000000>;
+	        f_min = <300000>;
+            f_max = <150000000>;
             max_req_size = <0x20000>;          /**128KB*/
             gpio_dat3 = "BOOT_3";
             card_type = <1>; /* 0:unknown, 1:mmc card(include eMMC), 2:sd card(include tSD), 3:sdio device(ie:sdio-wifi), 4:SD combo (IO+mem) card, 5:NON sdio device(means sd/mmc card), other:reserved */
@@ -771,10 +758,10 @@
                  816000         875000      875000
                 1008000         925000      925000
                 1200000         975000      975000
-                1416000        1025000     1025000
-                1608000        1100000     1100000
-                1800000        1125000     1125000
-                1992000        1150000     1150000
+                1416000        1150000     1150000
+                1608000        1150000     1150000
+                1800000        1200000     1200000
+                1992000        1200000     1200000
             >;
         };
     };
@@ -974,8 +961,8 @@
 		status = "ok";
 		reg = <0xd0048600 0x24>;
 		pinctrl-names = "nand_rb_mod","nand_norb_mod";
-		pinctrl-0 = <&nand_input_state &conf_nand_state &conf_nand_state1 &nand_base>;
-		pinctrl-1 = <&nand_input_state &conf_nand_state &conf_nand_state1 &nand_base>;
+		pinctrl-0 = <&nand_input_state &conf_nand_state &nand_base>;
+		pinctrl-1 = <&nand_input_state &conf_nand_state &nand_base>;
 		device_id = <0>;
 		plat-names = "nandnormal";
 		plat-num = <1>;
@@ -1074,8 +1061,6 @@
     audio_spdif_codec{
         compatible = "amlogic,aml-spdif-codec";
         dev_name = "spdif-dit.0";
-        pinctrl-names = "aml_audio_spdif";
-        pinctrl-0 = <&audio_spdif_pins>;
         status = "okay";
     };
 
@@ -1262,7 +1247,7 @@
 		compatible = "amlogic,unifykey";
 		status = "ok";
 
-		/*efuse-version = <20>;*/ /*m6 efuse version 2,m3 efuse version 1, not config efuse version in default*/
+		/*efuse-version = <0>;*/ /*m6 efuse version 2,m3 efuse version 1, not config efuse version in default*/
 		unifykey-num = <6>;
 		unifykey-index-0 = <&keysn_0>;
 		unifykey-index-1 = <&keysn_1>;
@@ -1292,7 +1277,7 @@
 		keysn_1:key_1{
 			key-name = "mac";
 			key-device = "nandkey";
-			key-dataformat = "hexdata";
+			key-dataformat = "allascii";
 			key-permit = "read","write","del";
 		};
 
@@ -1469,13 +1454,8 @@
 			amlogic,pins = "BOOT_0","BOOT_1","BOOT_2","BOOT_3","BOOT_4",
 						"BOOT_5","BOOT_6","BOOT_7","BOOT_15";
 			amlogic,pullup=<0>;
-	    		amlogic,pullupen=<1>;
-		};
-		conf_nand_state1: conf_nand1{
-			amlogic,pins = "BOOT_8", "BOOT_10";
-			amlogic,pullup=<1>;
-			amlogic,pullupen=<1>;
 		};
+
 //$$ MATCH "Nand_pin_0_match" = "&nand_base"
 //$$ MATCH "Nand_pin_1_match" = "&nand_base"
 //$$ L2 PROP_U32 2 = "amlogic,setmask"
@@ -1648,13 +1628,6 @@
             amlogic,pullupen=<1>;
         };
 
-//$$ MATCH "sdhc_pin_0_match" = "&sdhc_sd_clk_cmd_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 4*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 2 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
         sdhc_sd_clk_cmd_pins:sdhc_sd_clk_cmd_pins{
             amlogic,setmask=<2 0x00000030>;         /*sdhc b*/
             amlogic,clrmask=<5 0x00007c00           /*sdhc a*/
@@ -1666,13 +1639,6 @@
             amlogic,pullup=<1>;
             amlogic,pullupen=<1>;
         };
-//$$ MATCH "sdhc_pin_1_match" = "&sdhc_sd_all_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 4*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 6 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
         sdhc_sd_all_pins:sdhc_sd_all_pins{
             amlogic,setmask=<2 0x000000f0>;         /*sdhc b*/
             amlogic,clrmask=<5 0x00007c00           /*sdhc a*/
@@ -1684,13 +1650,7 @@
             amlogic,pullup=<1>;
             amlogic,pullupen=<1>;
         };
-//$$ MATCH "sdhc_pin_2_match" = "&sdhc_emmc_clk_cmd_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 3*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 2 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
+
         sdhc_emmc_clk_cmd_pins:sdhc_emmc_clk_cmd_pins{
             amlogic,setmask=<4 0x0c000000>;         /*bit[26-27] */
             amlogic,clrmask=<2 0x04c000f0           /*sdhc b & nand*/
@@ -1701,13 +1661,6 @@
             amlogic,pullup=<1>;
             amlogic,pullupen=<1>;
         };
-//$$ MATCH "sdhc_pin_3_match" = "&sdhc_emmc_all_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 3*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 10 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
         sdhc_emmc_all_pins:sdhc_emmc_all_pins{
             amlogic,setmask=<4 0x7c000000>;         /*sdhc c*/
             amlogic,clrmask=<2 0x04c000f0           /*sdhc b & nand*/
@@ -1718,13 +1671,7 @@
             amlogic,pullup=<1>;
             amlogic,pullupen=<1>;
         };
-//$$ MATCH "sdhc_pin_4_match" = "&sdhc_sdio_clk_cmd_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 3*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 2 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
+
         sdhc_sdio_clk_cmd_pins:sdhc_sdio_clk_cmd_pins{
             amlogic,setmask=<5 0x00000c00>;         /*sdhc a bit[10-11] */
             amlogic,clrmask=<2 0x058000f0           /*sdhc b*/
@@ -1735,13 +1682,6 @@
             amlogic,pullup=<1>;
             amlogic,pullupen=<1>;
         };
-//$$ MATCH "sdhc_pin_5_match" = "&sdhc_sdio_all_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 3*2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 6 = "amlogic,pins"
-//$$ L2 PROP_U32 = "amlogic,enable-output"
-//$$ L2 PROP_U32 = "amlogic,pullup"
-//$$ L2 PROP_U32 = "amlogic,pullupen"
         sdhc_sdio_all_pins:sdhc_sdio_all_pins{
             amlogic,setmask=<5 0x00006c00>;         /*sdhc a*/
             amlogic,clrmask=<2 0x058000f0           /*sdhc b*/
@@ -1824,24 +1764,16 @@
 //$$ L2 PROP_U32 4 = "amlogic,clrmask"
 //$$ L2 PROP_STR 8 = "amlogic,pins"
         audio_pins:audio_pin{
-            amlogic,setmask=<3 0x78000000      /*bt pcm*/
+            amlogic,setmask=<1 0x80
+	                     3 0x78000000      /*bt pcm*/
                              10 0x78000000>;  /*external audio codec*/
-            amlogic,clrmask=<4 0x3c000         /*bt pcm*/
+            amlogic,clrmask=<1 0x10000
+	                     4 0x3c000         /*bt pcm*/            
                              5 0x1000>;        /*bt pcm*/
-            amlogic,pins = "GPIOX_4","GPIOX_5","GPIOX_6","GPIOX_7",        /*bt pcm*/
+            amlogic,pins = "GPIOY_3","GPIOX_4","GPIOX_5","GPIOX_6","GPIOX_7",        /*bt pcm*/
                            "GPIOAO_8","GPIOAO_9","GPIOAO_10","GPIOAO_11";  /*external audio codec*/
         };
 
-//$$ MATCH "Audio_pin_0_match" = "&audio_spdif_pins"
-//$$ L2 PROP_U32 2 = "amlogic,setmask"
-//$$ L2 PROP_U32 2 = "amlogic,clrmask"
-//$$ L2 PROP_STR 1 = "amlogic,pins"
-        audio_spdif_pins:audio_pin1{
-            amlogic,setmask=<1 0x80>;       /*spdif_out*/
-            amlogic,clrmask=<1 0x10000>;    /*spdif_out*/
-            amlogic,pins ="GPIOY_3";        /*spdif_out*/
-        };
-
 //$$ MATCH "Spi_pin_0_match" = "&aml_spi_nor_pins"
 //$$ L2 PROP_U32 2 = "amlogic,setmask"
 //$$ L2 PROP_U32 2 = "amlogic,clrmask"
@@ -1903,7 +1835,7 @@
                 phy_interface = <1>;
                 new_maclogic = <1>;
                 reset_pin_enable = <0>;
-                reset_pin = "GPIOH_4";
+                reset_pin = "GPI0H_4";
                 reset_delay = <100>;
 	};
 
